<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- JAVA와 연결할 Mapper 파일 설정 -->
<mapper namespace="kopo.poly.persistance.mapper.IImgMapper">


	<!-- 게시판 등록시 파일 업로드 -->
	<insert id="insertFilePath" parameterType="OcrDTO">
		INSERT INTO BORD_FILE_INFO
		(
			FILE_SEQ,
			USER_ID,
			SAVE_SFILE_NAME,
			SAVE_FILE_PATH,
			SAVE_FILE_NAME,
			ORG_FILE_NAME,
			EXT,
			CHG_ID,
			CHG_DT,
			SAVE_THUMFILE_PATH

		)
		VALUES(
					  (SELECT IFNULL(MAX(FILE_SEQ),0)+1 FROM BORD_FILE_INFO B),
				  	  #{user_id},
		      		  #{save_sfile_name},
					  #{save_file_path},
					  #{save_file_name},
					  #{org_file_name},
					  #{ext},
					  #{chg_id},
					  #{chg_dt},
		       		  #{save_thumfile_path}

			  )
			  ON DUPLICATE KEY UPDATE
										   SAVE_FILE_PATH =#{save_file_path},
										   SAVE_FILE_NAME =#{save_file_name},
										   ORG_FILE_NAME =#{org_file_name},
										   SAVE_THUMFILE_PATH =#{save_thumfile_path},
										   EXT =#{ext},
										   CHG_DT =#{chg_dt}
	</insert>


	<!--사용자 이미지-->
	<select id="getFilePath" parameterType="OcrDTO"
			resultType="OcrDTO">
		SELECT SAVE_FILE_PATH,SAVE_FILE_NAME,SAVE_SFILE_NAME
		FROM BORD_FILE_INFO
		WHERE USER_ID = #{user_id}

	</select>
</mapper>